%
\begin{isabellebody}%
\setisabellecontext{TimSortProc}%
%
\isadelimtheory
%
\endisadelimtheory
%
\isatagtheory
\isacommand{theory}\isamarkupfalse%
\ TimSortProc\isanewline
\ \ \isakeyword{imports}\ {\isachardoublequoteopen}{\isachardot}{\isachardot}{\isacharslash}Simpl{\isacharslash}Vcg{\isachardoublequoteclose}\ Main\ {\isachardoublequoteopen}{\isachartilde}{\isachartilde}{\isacharslash}src{\isacharslash}HOL{\isacharslash}Library{\isacharslash}Code{\isacharunderscore}Target{\isacharunderscore}Numeral{\isachardoublequoteclose}\ {\isachardoublequoteopen}TimSortLemma{\isachardoublequoteclose}\isanewline
\isakeyword{begin}%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
\ \isanewline
%
\endisadelimtheory
\isanewline
\isacommand{hoarestate}\isamarkupfalse%
\ globals{\isacharunderscore}var\ {\isacharequal}\ \isanewline
\ stack{\isacharunderscore}size{\isacharcolon}{\isacharcolon}\ nat\isanewline
\ run{\isacharunderscore}base\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ list{\isachardoublequoteclose}\isanewline
\ run{\isacharunderscore}len\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}nat\ list{\isachardoublequoteclose}\isanewline
\ stack{\isacharunderscore}len\ {\isacharcolon}{\isacharcolon}\ nat\ \isanewline
\ a\ {\isacharcolon}{\isacharcolon}\ {\isachardoublequoteopen}int\ list{\isachardoublequoteclose}\ \isanewline
\ global{\isacharunderscore}min{\isacharunderscore}gallop\ {\isacharcolon}{\isacharcolon}\ nat\isanewline
\isanewline
\isanewline
\isacommand{procedures}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{imports}\ globals{\isacharunderscore}var{\isacharparenright}\isanewline
gallop{\isacharunderscore}left{\isacharparenleft}key{\isacharcolon}{\isacharcolon}int{\isacharcomma}array{\isacharcolon}{\isacharcolon}{\isachardoublequoteopen}int\ list{\isachardoublequoteclose}{\isacharcomma}base{\isacharcolon}{\isacharcolon}nat{\isacharcomma}len{\isacharcolon}{\isacharcolon}nat{\isacharcomma}hint{\isacharcolon}{\isacharcolon}nat{\isacharbar}ret{\isacharcolon}{\isacharcolon}nat{\isacharparenright}\isanewline
\isakeyword{where}\ last{\isacharunderscore}ofs{\isacharcolon}{\isacharcolon}nat\ ofs{\isacharcolon}{\isacharcolon}nat\ max{\isacharunderscore}ofs{\isacharcolon}{\isacharcolon}nat\ tmp{\isacharunderscore}gallop{\isacharcolon}{\isacharcolon}nat\ mid{\isacharcolon}{\isacharcolon}nat\ \isakeyword{in}\isanewline
{\isachardoublequoteopen}\isanewline
{\isasymacute}last{\isacharunderscore}ofs{\isacharcolon}{\isacharequal}{\isacharequal}{\isadigit{0}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
{\isasymacute}ofs{\isacharcolon}{\isacharequal}{\isacharequal}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
IF\ {\isasymacute}key{\isachargreater}{\isasymacute}array{\isacharbang}{\isacharparenleft}{\isasymacute}base{\isacharplus}{\isasymacute}hint{\isacharparenright}\ \isanewline
THEN\isanewline
\ {\isasymacute}max{\isacharunderscore}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}len\ {\isacharminus}\ {\isasymacute}hint{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ WHILE\ {\isacharparenleft}{\isasymacute}ofs\ {\isacharless}\ {\isasymacute}max{\isacharunderscore}ofs\ {\isacharampersand}\ {\isasymacute}key\ {\isachargreater}\ {\isasymacute}array{\isacharbang}{\isacharparenleft}{\isasymacute}base{\isacharplus}{\isasymacute}hint{\isacharplus}{\isasymacute}ofs{\isacharparenright}{\isacharparenright}\isanewline
\ DO\isanewline
\ \ {\isasymacute}last{\isacharunderscore}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}ofs{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}ofs{\isacharplus}{\isasymacute}ofs{\isacharplus}{\isadigit{1}}\isanewline
\ OD\ {\isacharsemicolon}{\isacharsemicolon}\isanewline
\ IF\ {\isasymacute}ofs\ {\isachargreater}\ {\isasymacute}max{\isacharunderscore}ofs\ THEN\ {\isasymacute}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}max{\isacharunderscore}ofs\ FI\ {\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}last{\isacharunderscore}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}last{\isacharunderscore}ofs\ {\isacharplus}\ {\isasymacute}hint{\isacharplus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}ofs\ {\isacharplus}\ {\isasymacute}hint\isanewline
ELSE\isanewline
\ {\isasymacute}max{\isacharunderscore}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}hint\ {\isacharplus}\ {\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ WHILE\ {\isacharparenleft}{\isasymacute}ofs\ {\isacharless}\ {\isasymacute}max{\isacharunderscore}ofs\ {\isacharampersand}\ {\isasymacute}key\ {\isasymle}\ {\isasymacute}array{\isacharbang}{\isacharparenleft}{\isasymacute}base{\isacharplus}{\isasymacute}hint{\isacharminus}{\isasymacute}ofs{\isacharparenright}{\isacharparenright}\isanewline
\ DO\isanewline
\ \ {\isasymacute}last{\isacharunderscore}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}ofs{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}ofs{\isacharplus}{\isasymacute}ofs{\isacharplus}{\isadigit{1}}\isanewline
\ OD\ {\isacharsemicolon}{\isacharsemicolon}\isanewline
\ IF\ {\isasymacute}ofs\ {\isachargreater}\ {\isasymacute}max{\isacharunderscore}ofs\ THEN\ {\isasymacute}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}max{\isacharunderscore}ofs\ FI\ {\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}tmp{\isacharunderscore}gallop\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}last{\isacharunderscore}ofs{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}last{\isacharunderscore}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}hint{\isacharplus}{\isadigit{1}}\ {\isacharminus}\ {\isasymacute}ofs{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}hint\ {\isacharminus}\ {\isasymacute}tmp{\isacharunderscore}gallop\isanewline
FI\ {\isacharsemicolon}{\isacharsemicolon}\isanewline
WHILE\ {\isacharparenleft}{\isasymacute}last{\isacharunderscore}ofs\ {\isacharless}\ {\isasymacute}ofs{\isacharparenright}\isanewline
DO\isanewline
\ {\isasymacute}mid\ {\isacharcolon}{\isacharequal}{\isacharequal}\ \ {\isacharparenleft}{\isasymacute}ofs\ {\isacharplus}\ {\isasymacute}last{\isacharunderscore}ofs{\isacharparenright}div\ {\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ IF\ {\isacharparenleft}{\isasymacute}key\ {\isachargreater}\ {\isasymacute}array{\isacharbang}{\isacharparenleft}{\isasymacute}base{\isacharplus}{\isasymacute}mid{\isacharparenright}{\isacharparenright}\isanewline
\ THEN\isanewline
\ \ {\isasymacute}last{\isacharunderscore}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}mid{\isacharplus}{\isadigit{1}}\isanewline
\ ELSE\isanewline
\ \ {\isasymacute}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}mid\isanewline
\ FI\isanewline
OD{\isacharsemicolon}{\isacharsemicolon}\isanewline
{\isasymacute}ret\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}ofs\isanewline
{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{procedures}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{imports}\ globals{\isacharunderscore}var{\isacharparenright}\isanewline
gallop{\isacharunderscore}right{\isacharparenleft}key{\isacharcolon}{\isacharcolon}int{\isacharcomma}array{\isacharcolon}{\isacharcolon}{\isachardoublequoteopen}int\ list{\isachardoublequoteclose}{\isacharcomma}base{\isacharcolon}{\isacharcolon}nat{\isacharcomma}len{\isacharcolon}{\isacharcolon}nat{\isacharcomma}hint{\isacharcolon}{\isacharcolon}nat{\isacharbar}ret{\isacharcolon}{\isacharcolon}nat{\isacharparenright}\isanewline
\isakeyword{where}\ last{\isacharunderscore}ofs{\isacharcolon}{\isacharcolon}nat\ ofs{\isacharcolon}{\isacharcolon}nat\ max{\isacharunderscore}ofs{\isacharcolon}{\isacharcolon}nat\ tmp{\isacharunderscore}gallop{\isacharcolon}{\isacharcolon}nat\ mid{\isacharcolon}{\isacharcolon}nat\ \isakeyword{in}\isanewline
{\isachardoublequoteopen}\isanewline
{\isacharparenleft}{\isacharasterisk}\ {\isasymacute}stack{\isacharunderscore}len\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}stack{\isacharunderscore}len{\isacharsemicolon}{\isacharsemicolon}\ \ unnecessary\ but\ the\ spec\ need\ globals\ be\ modified\ {\isacharasterisk}{\isacharparenright}\isanewline
{\isasymacute}last{\isacharunderscore}ofs{\isacharcolon}{\isacharequal}{\isacharequal}{\isadigit{0}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
{\isasymacute}ofs{\isacharcolon}{\isacharequal}{\isacharequal}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
IF\ {\isasymacute}key{\isacharless}{\isasymacute}array{\isacharbang}{\isacharparenleft}{\isasymacute}base{\isacharplus}{\isasymacute}hint{\isacharparenright}\ \isanewline
THEN\isanewline
\ {\isasymacute}max{\isacharunderscore}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}hint\ {\isacharplus}\ {\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ WHILE\ {\isacharparenleft}{\isasymacute}ofs\ {\isacharless}\ {\isasymacute}max{\isacharunderscore}ofs\ {\isacharampersand}\ {\isasymacute}key\ {\isacharless}\ {\isasymacute}array{\isacharbang}{\isacharparenleft}{\isasymacute}base{\isacharplus}{\isasymacute}hint{\isacharminus}{\isasymacute}ofs{\isacharparenright}{\isacharparenright}\isanewline
\ DO\isanewline
\ \ {\isasymacute}last{\isacharunderscore}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}ofs{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}ofs{\isacharplus}{\isasymacute}ofs{\isacharplus}{\isadigit{1}}\isanewline
\ OD\ {\isacharsemicolon}{\isacharsemicolon}\isanewline
\ IF\ {\isasymacute}ofs\ {\isachargreater}\ {\isasymacute}max{\isacharunderscore}ofs\ THEN\ {\isasymacute}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}max{\isacharunderscore}ofs\ FI\ {\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}tmp{\isacharunderscore}gallop\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}last{\isacharunderscore}ofs{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}last{\isacharunderscore}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}hint{\isacharplus}{\isadigit{1}}\ {\isacharminus}\ {\isasymacute}ofs{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}hint\ {\isacharminus}\ {\isasymacute}tmp{\isacharunderscore}gallop\isanewline
ELSE\isanewline
\ {\isasymacute}max{\isacharunderscore}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}len\ {\isacharminus}\ {\isasymacute}hint{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ WHILE\ {\isacharparenleft}{\isasymacute}ofs\ {\isacharless}\ {\isasymacute}max{\isacharunderscore}ofs\ {\isacharampersand}\ {\isasymacute}key\ {\isasymge}\ {\isasymacute}array{\isacharbang}{\isacharparenleft}{\isasymacute}base{\isacharplus}{\isasymacute}hint{\isacharplus}{\isasymacute}ofs{\isacharparenright}{\isacharparenright}\isanewline
\ DO\isanewline
\ \ {\isasymacute}last{\isacharunderscore}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}ofs{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}ofs{\isacharplus}{\isasymacute}ofs{\isacharplus}{\isadigit{1}}\isanewline
\ OD\ {\isacharsemicolon}{\isacharsemicolon}\isanewline
\ IF\ {\isasymacute}ofs\ {\isachargreater}\ {\isasymacute}max{\isacharunderscore}ofs\ THEN\ {\isasymacute}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}max{\isacharunderscore}ofs\ FI\ {\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}last{\isacharunderscore}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}last{\isacharunderscore}ofs\ {\isacharplus}\ {\isasymacute}hint{\isacharplus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}ofs\ {\isacharplus}\ {\isasymacute}hint\isanewline
FI\ {\isacharsemicolon}{\isacharsemicolon}\isanewline
WHILE\ {\isacharparenleft}{\isasymacute}last{\isacharunderscore}ofs\ {\isacharless}\ {\isasymacute}ofs{\isacharparenright}\isanewline
DO\isanewline
\ {\isasymacute}mid\ {\isacharcolon}{\isacharequal}{\isacharequal}\ \ {\isacharparenleft}{\isasymacute}ofs\ {\isacharplus}\ {\isasymacute}last{\isacharunderscore}ofs{\isacharparenright}div\ {\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ IF\ {\isacharparenleft}{\isasymacute}key\ {\isacharless}\ {\isasymacute}array{\isacharbang}{\isacharparenleft}{\isasymacute}base{\isacharplus}{\isasymacute}mid{\isacharparenright}{\isacharparenright}\isanewline
\ THEN\isanewline
\ \ {\isasymacute}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}mid\isanewline
\ ELSE\isanewline
\ \ {\isasymacute}last{\isacharunderscore}ofs\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}mid{\isacharplus}{\isadigit{1}}\isanewline
\ FI\isanewline
OD{\isacharsemicolon}{\isacharsemicolon}\isanewline
{\isasymacute}ret\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}ofs\isanewline
{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isacommand{value}\isamarkupfalse%
\ {\isachardoublequoteopen}replicate\ {\isacharparenleft}{\isadigit{3}}{\isacharcolon}{\isacharcolon}nat{\isacharparenright}\ {\isacharparenleft}{\isadigit{4}}{\isacharcolon}{\isacharcolon}nat{\isacharparenright}{\isachardoublequoteclose}\isanewline
\isacommand{value}\isamarkupfalse%
\ {\isachardoublequoteopen}list{\isacharunderscore}copy\ {\isacharbrackleft}{\isadigit{1}}{\isacharcomma}{\isadigit{2}}{\isacharcomma}{\isadigit{3}}{\isacharcolon}{\isacharcolon}int{\isacharbrackright}\ {\isadigit{6}}\ {\isacharbrackleft}{\isadigit{1}}{\isacharcomma}{\isadigit{2}}{\isacharcomma}{\isadigit{3}}{\isacharcolon}{\isacharcolon}int{\isacharbrackright}\ {\isadigit{1}}\ {\isadigit{2}}{\isachardoublequoteclose}\isanewline
\isacommand{procedures}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{imports}\ globals{\isacharunderscore}var{\isacharparenright}\isanewline
merge{\isacharunderscore}lo\ {\isacharparenleft}base{\isadigit{1}}{\isacharcolon}{\isacharcolon}nat{\isacharcomma}\ len{\isadigit{1}}{\isacharcolon}{\isacharcolon}nat{\isacharcomma}\ base{\isadigit{2}}{\isacharcolon}{\isacharcolon}nat{\isacharcomma}\ len{\isadigit{2}}{\isacharcolon}{\isacharcolon}nat{\isacharparenright}\isanewline
\isakeyword{where}\ tmp{\isacharcolon}{\isacharcolon}{\isachardoublequoteopen}int\ list{\isachardoublequoteclose}\ cursor{\isadigit{1}}{\isacharcolon}{\isacharcolon}nat\ cursor{\isadigit{2}}{\isacharcolon}{\isacharcolon}nat\ dest{\isacharcolon}{\isacharcolon}nat\ \isanewline
min{\isacharunderscore}gallop{\isacharcolon}{\isacharcolon}nat\ count{\isadigit{1}}{\isacharcolon}{\isacharcolon}nat\ count{\isadigit{2}}{\isacharcolon}{\isacharcolon}nat\ \isakeyword{in}\isanewline
{\isachardoublequoteopen}\isanewline
TRY\isanewline
\ \ {\isasymacute}tmp\ {\isacharcolon}{\isacharequal}{\isacharequal}\ replicate\ {\isasymacute}len{\isadigit{1}}\ {\isacharparenleft}{\isadigit{0}}{\isacharcolon}{\isacharcolon}int{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}tmp\ {\isacharcolon}{\isacharequal}{\isacharequal}\ list{\isacharunderscore}copy\ {\isasymacute}tmp\ {\isacharparenleft}{\isadigit{0}}{\isacharcolon}{\isacharcolon}nat{\isacharparenright}\ {\isasymacute}a\ {\isasymacute}base{\isadigit{1}}\ {\isasymacute}len{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}cursor{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isadigit{0}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}cursor{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}{\isasymacute}base{\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}base{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}a{\isacharbang}{\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}a{\isacharbang}{\isasymacute}cursor{\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}dest{\isacharplus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}cursor{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}cursor{\isadigit{2}}{\isacharplus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}len{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}len{\isadigit{2}}{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}min{\isacharunderscore}gallop\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}global{\isacharunderscore}min{\isacharunderscore}gallop{\isacharsemicolon}{\isacharsemicolon}{\isacharparenleft}{\isacharasterisk}\ need\ to\ add\ min\ gallop\ to\ globals\ var\ {\isacharasterisk}{\isacharparenright}\isanewline
\ \ IF\ {\isasymacute}len{\isadigit{2}}{\isacharequal}{\isadigit{0}}\ THEN\ {\isasymacute}a\ {\isacharcolon}{\isacharequal}{\isacharequal}\ list{\isacharunderscore}copy\ {\isasymacute}a\ {\isasymacute}dest\ {\isasymacute}tmp\ {\isasymacute}cursor{\isadigit{1}}\ {\isasymacute}len{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\ THROW\ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ IF\ {\isasymacute}len{\isadigit{1}}{\isacharequal}{\isadigit{1}}\ THEN\ {\isasymacute}a\ {\isacharcolon}{\isacharequal}{\isacharequal}\ list{\isacharunderscore}copy\ {\isasymacute}a\ {\isasymacute}dest\ {\isasymacute}a\ {\isasymacute}cursor{\isadigit{2}}\ {\isasymacute}len{\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\ {\isasymacute}a{\isacharbang}{\isacharparenleft}{\isasymacute}dest{\isacharplus}{\isasymacute}len{\isadigit{2}}{\isacharparenright}{\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}tmp{\isacharbang}{\isasymacute}cursor{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}THROW\ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ TRY\isanewline
\ \ \ \ WHILE\ True\ \isanewline
\ \ \ \ DO\isanewline
\ \ \ \ \ \ {\isasymacute}count{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isadigit{0}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ {\isasymacute}count{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isadigit{0}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ WHILE\ {\isacharparenleft}{\isasymacute}count{\isadigit{1}}\ {\isacharless}\ {\isasymacute}min{\isacharunderscore}gallop\ {\isacharampersand}\ {\isasymacute}count{\isadigit{2}}\ {\isacharless}\ {\isasymacute}min{\isacharunderscore}gallop{\isacharparenright}\isanewline
\ \ \ \ \ \ DO\isanewline
\ \ \ \ \ \ \ \ IF\ {\isasymacute}a{\isacharbang}{\isasymacute}cursor{\isadigit{2}}\ {\isacharless}\ {\isasymacute}tmp{\isacharbang}{\isasymacute}cursor{\isadigit{1}}\isanewline
\ \ \ \ \ \ \ \ THEN\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}a{\isacharbang}{\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}a{\isacharbang}{\isasymacute}cursor{\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}dest{\isacharplus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}cursor{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}cursor{\isadigit{2}}{\isacharplus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}count{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}count{\isadigit{2}}{\isacharplus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}count{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isadigit{0}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}len{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}len{\isadigit{2}}{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ IF\ {\isasymacute}len{\isadigit{2}}\ {\isacharequal}\ {\isadigit{0}}\ THEN\ THROW\ FI\isanewline
\ \ \ \ \ \ \ \ ELSE\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}a{\isacharbang}{\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}tmp{\isacharbang}{\isasymacute}cursor{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}dest{\isacharplus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}cursor{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}cursor{\isadigit{1}}{\isacharplus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}count{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}count{\isadigit{1}}{\isacharplus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}count{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isadigit{0}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}len{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}len{\isadigit{1}}{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ IF\ {\isasymacute}len{\isadigit{1}}\ {\isacharequal}\ {\isadigit{1}}\ THEN\ THROW\ FI\isanewline
\ \ \ \ \ \ \ \ FI\isanewline
\ \ \ \ \ \ OD{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ WHILE\ {\isacharparenleft}{\isasymacute}count{\isadigit{1}}\ {\isasymge}\ {\isasymacute}global{\isacharunderscore}min{\isacharunderscore}gallop\ {\isacharbar}\ {\isasymacute}count{\isadigit{2}}\ {\isasymge}\ {\isasymacute}global{\isacharunderscore}min{\isacharunderscore}gallop{\isacharparenright}\isanewline
\ \ \ \ \ \ DO\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}count{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ CALL\ gallop{\isacharunderscore}right{\isacharparenleft}{\isasymacute}a{\isacharbang}{\isasymacute}cursor{\isadigit{2}}{\isacharcomma}\ {\isasymacute}tmp{\isacharcomma}\ {\isasymacute}cursor{\isadigit{1}}{\isacharcomma}\ {\isasymacute}len{\isadigit{1}}{\isacharcomma}\ {\isadigit{0}}{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ IF\ {\isasymacute}count{\isadigit{1}}\ {\isasymnoteq}\ {\isadigit{0}}\isanewline
\ \ \ \ \ \ \ \ THEN\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}a\ {\isacharcolon}{\isacharequal}{\isacharequal}\ list{\isacharunderscore}copy\ {\isasymacute}a\ {\isasymacute}dest\ {\isasymacute}tmp\ {\isasymacute}cursor{\isadigit{1}}\ {\isasymacute}count{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}dest{\isacharplus}{\isasymacute}count{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}cursor{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}cursor{\isadigit{1}}{\isacharplus}{\isasymacute}count{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}len{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}len{\isadigit{1}}{\isacharminus}{\isasymacute}count{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ IF\ {\isasymacute}len{\isadigit{1}}{\isasymle}{\isadigit{1}}\ THEN\ THROW\ FI\isanewline
\ \ \ \ \ \ \ \ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}a{\isacharbang}{\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}a{\isacharbang}{\isasymacute}cursor{\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}dest{\isacharplus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}cursor{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}cursor{\isadigit{2}}{\isacharplus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}len{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}len{\isadigit{2}}{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ IF\ {\isasymacute}len{\isadigit{2}}\ {\isacharequal}\ {\isadigit{0}}\ THEN\ THROW\ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}count{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ CALL\ gallop{\isacharunderscore}left{\isacharparenleft}{\isasymacute}tmp{\isacharbang}{\isasymacute}cursor{\isadigit{1}}{\isacharcomma}\ {\isasymacute}a{\isacharcomma}\ {\isasymacute}cursor{\isadigit{2}}{\isacharcomma}\ {\isasymacute}len{\isadigit{2}}{\isacharcomma}\ {\isadigit{0}}{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ IF\ {\isasymacute}count{\isadigit{2}}\ {\isasymnoteq}\ {\isadigit{0}}\isanewline
\ \ \ \ \ \ \ \ THEN\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}a\ {\isacharcolon}{\isacharequal}{\isacharequal}\ list{\isacharunderscore}copy\ {\isasymacute}a\ {\isasymacute}dest\ {\isasymacute}a\ {\isasymacute}cursor{\isadigit{2}}\ {\isasymacute}count{\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}dest{\isacharplus}{\isasymacute}count{\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}cursor{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}cursor{\isadigit{2}}{\isacharplus}{\isasymacute}count{\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}len{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}len{\isadigit{2}}{\isacharminus}{\isasymacute}count{\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ IF\ {\isasymacute}len{\isadigit{2}}\ {\isacharequal}\ {\isadigit{0}}\ THEN\ THROW\ FI\isanewline
\ \ \ \ \ \ \ \ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}a{\isacharbang}{\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}tmp{\isacharbang}{\isasymacute}cursor{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}dest{\isacharplus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}cursor{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}cursor{\isadigit{1}}{\isacharplus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}len{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}len{\isadigit{1}}{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ IF\ {\isasymacute}len{\isadigit{1}}\ {\isacharequal}\ {\isadigit{1}}\ THEN\ THROW\ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}min{\isacharunderscore}gallop\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}min{\isacharunderscore}gallop{\isacharminus}{\isadigit{1}}\isanewline
\ \ \ \ \ \ OD{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ IF\ {\isasymacute}min{\isacharunderscore}gallop\ {\isacharless}\ {\isadigit{0}}\ THEN\ {\isasymacute}min{\isacharunderscore}gallop\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isadigit{0}}\ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ {\isasymacute}min{\isacharunderscore}gallop\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}min{\isacharunderscore}gallop\ {\isacharplus}\ {\isadigit{2}}\isanewline
\ \ \ \ OD\isanewline
\ \ CATCH\isanewline
\ \ Skip\isanewline
\ \ END{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ IF\ {\isasymacute}len{\isadigit{1}}\ {\isacharequal}\ {\isadigit{1}}\isanewline
\ \ THEN\ {\isasymacute}a\ {\isacharcolon}{\isacharequal}{\isacharequal}\ list{\isacharunderscore}copy\ {\isasymacute}a\ {\isasymacute}dest\ {\isasymacute}a\ {\isasymacute}cursor{\isadigit{2}}\ {\isasymacute}len{\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}{\isasymacute}a{\isacharbang}{\isacharparenleft}{\isasymacute}dest{\isacharplus}{\isasymacute}len{\isadigit{2}}{\isacharparenright}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}tmp{\isacharbang}{\isasymacute}cursor{\isadigit{1}}\isanewline
\ \ ELSE\ IF\ {\isasymacute}len{\isadigit{1}}\ {\isacharequal}\ {\isadigit{0}}\isanewline
\ \ \ \ \ \ \ THEN\ Skip\isanewline
\ \ \ \ \ \ \ ELSE\ {\isasymacute}a\ {\isacharcolon}{\isacharequal}{\isacharequal}\ list{\isacharunderscore}copy\ {\isasymacute}a\ {\isasymacute}dest\ {\isasymacute}tmp\ {\isasymacute}cursor{\isadigit{1}}\ {\isasymacute}len{\isadigit{1}}\ \isanewline
\ \ \ \ \ \ \ FI\isanewline
\ \ FI\isanewline
CATCH\isanewline
Skip\isanewline
END\isanewline
{\isachardoublequoteclose}\isanewline
\isacommand{procedures}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{imports}\ globals{\isacharunderscore}var{\isacharparenright}\isanewline
merge{\isacharunderscore}hi\ {\isacharparenleft}base{\isadigit{1}}{\isacharcolon}{\isacharcolon}nat{\isacharcomma}\ len{\isadigit{1}}{\isacharcolon}{\isacharcolon}nat{\isacharcomma}\ base{\isadigit{2}}{\isacharcolon}{\isacharcolon}nat{\isacharcomma}\ len{\isadigit{2}}{\isacharcolon}{\isacharcolon}nat{\isacharparenright}\isanewline
\isakeyword{where}\ tmp{\isacharcolon}{\isacharcolon}{\isachardoublequoteopen}int\ list{\isachardoublequoteclose}\ cursor{\isadigit{1}}{\isacharcolon}{\isacharcolon}nat\ cursor{\isadigit{2}}{\isacharcolon}{\isacharcolon}nat\ dest{\isacharcolon}{\isacharcolon}nat\ \isanewline
min{\isacharunderscore}gallop{\isacharcolon}{\isacharcolon}nat\ count{\isadigit{1}}{\isacharcolon}{\isacharcolon}nat\ count{\isadigit{2}}{\isacharcolon}{\isacharcolon}nat\ count{\isacharunderscore}tmp{\isacharcolon}{\isacharcolon}nat\ \isakeyword{in}\isanewline
{\isachardoublequoteopen}\isanewline
TRY\isanewline
\ \ {\isasymacute}tmp\ {\isacharcolon}{\isacharequal}{\isacharequal}\ replicate\ {\isasymacute}len{\isadigit{2}}\ {\isacharparenleft}{\isadigit{0}}{\isacharcolon}{\isacharcolon}int{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}tmp\ {\isacharcolon}{\isacharequal}{\isacharequal}\ list{\isacharunderscore}copy\ {\isasymacute}tmp\ {\isacharparenleft}{\isadigit{0}}{\isacharcolon}{\isacharcolon}nat{\isacharparenright}\ {\isasymacute}a\ {\isasymacute}base{\isadigit{2}}\ {\isasymacute}len{\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}cursor{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}base{\isadigit{1}}{\isacharplus}{\isasymacute}len{\isadigit{1}}{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}cursor{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}{\isasymacute}len{\isadigit{2}}{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}base{\isadigit{2}}{\isacharplus}{\isasymacute}len{\isadigit{2}}{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}a{\isacharbang}{\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}a{\isacharbang}{\isasymacute}cursor{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}dest{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}cursor{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}cursor{\isadigit{1}}{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}len{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}len{\isadigit{1}}{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}min{\isacharunderscore}gallop\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}global{\isacharunderscore}min{\isacharunderscore}gallop{\isacharsemicolon}{\isacharsemicolon}{\isacharparenleft}{\isacharasterisk}\ need\ to\ add\ min\ gallop\ to\ globals\ var\ {\isacharasterisk}{\isacharparenright}\isanewline
\ \ IF\ {\isasymacute}len{\isadigit{1}}{\isacharequal}{\isadigit{0}}\ THEN\ {\isasymacute}a\ {\isacharcolon}{\isacharequal}{\isacharequal}\ list{\isacharunderscore}copy\ {\isasymacute}a\ {\isacharparenleft}{\isasymacute}dest{\isacharminus}{\isacharparenleft}{\isasymacute}len{\isadigit{2}}{\isacharminus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isasymacute}tmp\ {\isadigit{0}}\ {\isasymacute}len{\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\ THROW\ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ IF\ {\isasymacute}len{\isadigit{2}}{\isacharequal}{\isadigit{1}}\ \isanewline
\ \ THEN\ \isanewline
\ \ \ \ {\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}dest{\isacharminus}{\isasymacute}len{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ {\isasymacute}cursor{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}cursor{\isadigit{1}}{\isacharminus}{\isasymacute}len{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ {\isasymacute}a\ {\isacharcolon}{\isacharequal}{\isacharequal}\ list{\isacharunderscore}copy\ {\isasymacute}a\ {\isacharparenleft}{\isasymacute}dest{\isacharplus}{\isadigit{1}}{\isacharparenright}\ {\isasymacute}a\ {\isacharparenleft}{\isasymacute}cursor{\isadigit{1}}{\isacharplus}{\isadigit{1}}{\isacharparenright}\ {\isasymacute}len{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\ \isanewline
\ \ \ \ {\isasymacute}a{\isacharbang}{\isasymacute}dest{\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}tmp{\isacharbang}{\isasymacute}cursor{\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ THROW\ \isanewline
\ \ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ TRY\isanewline
\ \ \ \ WHILE\ True\ \isanewline
\ \ \ \ DO\isanewline
\ \ \ \ \ \ {\isasymacute}count{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isadigit{0}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ {\isasymacute}count{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isadigit{0}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ WHILE\ {\isacharparenleft}{\isasymacute}count{\isadigit{1}}\ {\isacharless}\ {\isasymacute}min{\isacharunderscore}gallop\ {\isacharampersand}\ {\isasymacute}count{\isadigit{2}}\ {\isacharless}\ {\isasymacute}min{\isacharunderscore}gallop{\isacharparenright}\isanewline
\ \ \ \ \ \ DO\isanewline
\ \ \ \ \ \ \ \ IF\ {\isasymacute}tmp{\isacharbang}{\isasymacute}cursor{\isadigit{2}}\ {\isacharless}\ {\isasymacute}a{\isacharbang}{\isasymacute}cursor{\isadigit{1}}\isanewline
\ \ \ \ \ \ \ \ THEN\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}a{\isacharbang}{\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}a{\isacharbang}{\isasymacute}cursor{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}dest{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}cursor{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}cursor{\isadigit{1}}{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}count{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}count{\isadigit{1}}{\isacharplus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}count{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isadigit{0}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}len{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}len{\isadigit{1}}{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ IF\ {\isasymacute}len{\isadigit{1}}\ {\isacharequal}\ {\isadigit{0}}\ THEN\ THROW\ FI\isanewline
\ \ \ \ \ \ \ \ ELSE\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}a{\isacharbang}{\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}tmp{\isacharbang}{\isasymacute}cursor{\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}dest{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}cursor{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}cursor{\isadigit{2}}{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}count{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}count{\isadigit{2}}{\isacharplus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}count{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isadigit{0}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}len{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}len{\isadigit{2}}{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ IF\ {\isasymacute}len{\isadigit{2}}\ {\isacharequal}\ {\isadigit{1}}\ THEN\ THROW\ FI\isanewline
\ \ \ \ \ \ \ \ FI\isanewline
\ \ \ \ \ \ OD{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ WHILE\ {\isacharparenleft}{\isasymacute}count{\isadigit{1}}\ {\isasymge}\ {\isasymacute}global{\isacharunderscore}min{\isacharunderscore}gallop\ {\isacharbar}\ {\isasymacute}count{\isadigit{2}}\ {\isasymge}\ {\isasymacute}global{\isacharunderscore}min{\isacharunderscore}gallop{\isacharparenright}\isanewline
\ \ \ \ \ \ DO\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}count{\isacharunderscore}tmp\ {\isacharcolon}{\isacharequal}{\isacharequal}\ \ CALL\ gallop{\isacharunderscore}right{\isacharparenleft}{\isasymacute}tmp{\isacharbang}{\isasymacute}cursor{\isadigit{2}}{\isacharcomma}\ {\isasymacute}a{\isacharcomma}\ {\isasymacute}base{\isadigit{1}}{\isacharcomma}\ {\isasymacute}len{\isadigit{1}}{\isacharcomma}\ {\isasymacute}len{\isadigit{1}}{\isacharminus}{\isadigit{1}}{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}count{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}len{\isadigit{1}}\ {\isacharminus}\ {\isasymacute}count{\isacharunderscore}tmp{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ IF\ {\isasymacute}count{\isadigit{1}}\ {\isasymnoteq}\ {\isadigit{0}}\isanewline
\ \ \ \ \ \ \ \ THEN\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}dest{\isacharminus}{\isasymacute}count{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}cursor{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}cursor{\isadigit{1}}{\isacharminus}{\isasymacute}count{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}len{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}len{\isadigit{1}}{\isacharminus}{\isasymacute}count{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}a\ {\isacharcolon}{\isacharequal}{\isacharequal}\ list{\isacharunderscore}copy\ {\isasymacute}a\ {\isacharparenleft}{\isasymacute}dest{\isacharplus}{\isadigit{1}}{\isacharparenright}\ {\isasymacute}a\ {\isacharparenleft}{\isasymacute}cursor{\isadigit{1}}{\isacharplus}{\isadigit{1}}{\isacharparenright}\ {\isasymacute}count{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ IF\ {\isasymacute}len{\isadigit{1}}{\isacharequal}{\isadigit{0}}\ THEN\ THROW\ FI\isanewline
\ \ \ \ \ \ \ \ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}a{\isacharbang}{\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}tmp{\isacharbang}{\isasymacute}cursor{\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}dest{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}cursor{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}cursor{\isadigit{2}}{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}len{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}len{\isadigit{2}}{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ IF\ {\isasymacute}len{\isadigit{2}}\ {\isacharequal}\ {\isadigit{1}}\ THEN\ THROW\ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}count{\isacharunderscore}tmp\ {\isacharcolon}{\isacharequal}{\isacharequal}\ CALL\ gallop{\isacharunderscore}left{\isacharparenleft}{\isasymacute}a{\isacharbang}{\isasymacute}cursor{\isadigit{1}}{\isacharcomma}\ {\isasymacute}tmp{\isacharcomma}\ {\isadigit{0}}{\isacharcomma}\ {\isasymacute}len{\isadigit{2}}{\isacharcomma}\ {\isacharparenleft}{\isasymacute}len{\isadigit{2}}{\isacharminus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}count{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}len{\isadigit{2}}\ {\isacharminus}\ {\isasymacute}count{\isacharunderscore}tmp{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ IF\ {\isasymacute}count{\isadigit{2}}\ {\isasymnoteq}\ {\isadigit{0}}\isanewline
\ \ \ \ \ \ \ \ THEN\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}dest{\isacharminus}{\isasymacute}count{\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}cursor{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}cursor{\isadigit{2}}{\isacharminus}{\isasymacute}count{\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}len{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}len{\isadigit{2}}{\isacharminus}{\isasymacute}count{\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ {\isasymacute}a\ {\isacharcolon}{\isacharequal}{\isacharequal}\ list{\isacharunderscore}copy\ {\isasymacute}a\ {\isacharparenleft}{\isasymacute}dest{\isacharplus}{\isadigit{1}}{\isacharparenright}\ {\isasymacute}tmp\ {\isacharparenleft}{\isasymacute}cursor{\isadigit{2}}{\isacharplus}{\isadigit{1}}{\isacharparenright}\ {\isasymacute}count{\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ \ \ IF\ {\isasymacute}len{\isadigit{2}}\ {\isasymle}\ {\isadigit{1}}\ THEN\ THROW\ FI\isanewline
\ \ \ \ \ \ \ \ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}a{\isacharbang}{\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}a{\isacharbang}{\isasymacute}cursor{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}dest{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}cursor{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}cursor{\isadigit{1}}{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}len{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}len{\isadigit{1}}{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ IF\ {\isasymacute}len{\isadigit{1}}\ {\isacharequal}\ {\isadigit{0}}\ THEN\ THROW\ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ \ {\isasymacute}min{\isacharunderscore}gallop\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}min{\isacharunderscore}gallop{\isacharminus}{\isadigit{1}}\isanewline
\ \ \ \ \ \ OD{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ IF\ {\isasymacute}min{\isacharunderscore}gallop\ {\isacharless}\ {\isadigit{0}}\ THEN\ {\isasymacute}min{\isacharunderscore}gallop\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isadigit{0}}\ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ {\isasymacute}min{\isacharunderscore}gallop\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}min{\isacharunderscore}gallop\ {\isacharplus}\ {\isadigit{2}}\isanewline
\ \ \ \ OD\isanewline
\ \ CATCH\isanewline
\ \ Skip\isanewline
\ \ END{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ IF\ {\isasymacute}len{\isadigit{2}}\ {\isacharequal}\ {\isadigit{1}}\isanewline
\ \ THEN\ \isanewline
\ \ \ \ {\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}dest{\isacharminus}{\isasymacute}len{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ {\isasymacute}cursor{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}cursor{\isadigit{1}}{\isacharminus}{\isasymacute}len{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ {\isasymacute}a\ {\isacharcolon}{\isacharequal}{\isacharequal}\ list{\isacharunderscore}copy\ {\isasymacute}a\ {\isacharparenleft}{\isasymacute}dest{\isacharplus}{\isadigit{1}}{\isacharparenright}\ {\isasymacute}a\ {\isacharparenleft}{\isasymacute}cursor{\isadigit{1}}{\isacharplus}{\isadigit{1}}{\isacharparenright}\ {\isasymacute}len{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ {\isasymacute}a{\isacharbang}{\isasymacute}dest\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}tmp{\isacharbang}{\isasymacute}cursor{\isadigit{2}}\isanewline
\ \ ELSE\ IF\ {\isasymacute}len{\isadigit{2}}\ {\isacharequal}\ {\isadigit{0}}\isanewline
\ \ \ \ \ \ \ THEN\ Skip\isanewline
\ \ \ \ \ \ \ ELSE\ {\isasymacute}a\ {\isacharcolon}{\isacharequal}{\isacharequal}\ list{\isacharunderscore}copy\ {\isasymacute}a\ {\isacharparenleft}{\isasymacute}dest{\isacharminus}{\isacharparenleft}{\isasymacute}len{\isadigit{2}}{\isacharminus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ {\isasymacute}tmp\ {\isadigit{0}}\ {\isasymacute}len{\isadigit{2}}\ \isanewline
\ \ \ \ \ \ \ FI\isanewline
\ \ FI\isanewline
CATCH\isanewline
Skip\isanewline
END\isanewline
{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{procedures}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{imports}\ globals{\isacharunderscore}var{\isacharparenright}\isanewline
merge{\isacharunderscore}at\ {\isacharparenleft}i{\isacharcolon}{\isacharcolon}nat{\isacharparenright}\isanewline
\isakeyword{where}\ k{\isacharcolon}{\isacharcolon}nat\ base{\isadigit{1}}{\isacharcolon}{\isacharcolon}nat\ base{\isadigit{2}}{\isacharcolon}{\isacharcolon}nat\ len{\isadigit{1}}{\isacharcolon}{\isacharcolon}nat\ len{\isadigit{2}}{\isacharcolon}{\isacharcolon}nat\ \isakeyword{in}\isanewline
{\isachardoublequoteopen}\isanewline
TRY\isanewline
\ \ {\isasymacute}base{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}run{\isacharunderscore}base{\isacharbang}{\isasymacute}i{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}len{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}run{\isacharunderscore}len{\isacharbang}{\isasymacute}i{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}base{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}run{\isacharunderscore}base{\isacharbang}{\isacharparenleft}{\isasymacute}i{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}len{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}run{\isacharunderscore}len{\isacharbang}{\isacharparenleft}{\isasymacute}i{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isacharparenleft}{\isasymacute}run{\isacharunderscore}len{\isacharbang}{\isasymacute}i{\isacharparenright}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}len{\isadigit{1}}\ {\isacharplus}\ {\isasymacute}len{\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ IF\ {\isasymacute}i{\isacharequal}{\isasymacute}stack{\isacharunderscore}size{\isacharminus}{\isadigit{3}}\isanewline
\ \ THEN\ {\isasymacute}run{\isacharunderscore}base{\isacharbang}{\isacharparenleft}{\isasymacute}i{\isacharplus}{\isadigit{1}}{\isacharparenright}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}run{\isacharunderscore}base{\isacharbang}{\isacharparenleft}{\isasymacute}i{\isacharplus}{\isadigit{2}}{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ \ \ \ {\isasymacute}run{\isacharunderscore}len{\isacharbang}{\isacharparenleft}{\isasymacute}i{\isacharplus}{\isadigit{1}}{\isacharparenright}\ {\isacharcolon}{\isacharequal}{\isacharequal}{\isacharparenleft}{\isasymacute}run{\isacharunderscore}len{\isacharbang}{\isacharparenleft}{\isasymacute}i{\isacharplus}{\isadigit{2}}{\isacharparenright}{\isacharparenright}\ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}stack{\isacharunderscore}size\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}stack{\isacharunderscore}size{\isacharminus}{\isadigit{1}}\ {\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isacharparenleft}{\isacharasterisk}\ the\ process\ of\ merge\ on\ the\ array\ {\isacharasterisk}{\isacharparenright}\isanewline
\ \ {\isasymacute}k\ {\isacharcolon}{\isacharequal}{\isacharequal}\ CALL\ gallop{\isacharunderscore}right{\isacharparenleft}{\isasymacute}a{\isacharbang}{\isasymacute}base{\isadigit{2}}{\isacharcomma}\ {\isasymacute}a{\isacharcomma}\ {\isasymacute}base{\isadigit{1}}{\isacharcomma}\ {\isasymacute}len{\isadigit{1}}{\isacharcomma}\ {\isadigit{0}}{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}base{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}base{\isadigit{1}}{\isacharplus}{\isasymacute}k{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}len{\isadigit{1}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}len{\isadigit{1}}{\isacharminus}{\isasymacute}k{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ IF\ {\isasymacute}len{\isadigit{1}}{\isacharequal}{\isadigit{0}}\ THEN\ THROW\ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}len{\isadigit{2}}\ {\isacharcolon}{\isacharequal}{\isacharequal}\ CALL\ gallop{\isacharunderscore}left{\isacharparenleft}{\isasymacute}a{\isacharbang}{\isacharparenleft}{\isasymacute}base{\isadigit{1}}{\isacharplus}{\isasymacute}len{\isadigit{1}}{\isacharminus}{\isadigit{1}}{\isacharparenright}{\isacharcomma}{\isasymacute}a{\isacharcomma}\ {\isasymacute}base{\isadigit{2}}{\isacharcomma}\ {\isasymacute}len{\isadigit{2}}{\isacharcomma}\ {\isasymacute}len{\isadigit{2}}{\isacharminus}{\isadigit{1}}{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ IF\ {\isasymacute}len{\isadigit{2}}{\isacharequal}{\isadigit{0}}\ THEN\ THROW\ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ IF\ {\isacharparenleft}{\isasymacute}len{\isadigit{1}}{\isasymle}{\isasymacute}len{\isadigit{2}}{\isacharparenright}\ \isanewline
\ \ THEN\ CALL\ merge{\isacharunderscore}lo{\isacharparenleft}{\isasymacute}base{\isadigit{1}}{\isacharcomma}\ {\isasymacute}len{\isadigit{1}}{\isacharcomma}\ {\isasymacute}base{\isadigit{2}}{\isacharcomma}\ {\isasymacute}len{\isadigit{2}}{\isacharparenright}\isanewline
\ \ ELSE\ CALL\ merge{\isacharunderscore}hi{\isacharparenleft}{\isasymacute}base{\isadigit{1}}{\isacharcomma}\ {\isasymacute}len{\isadigit{1}}{\isacharcomma}\ {\isasymacute}base{\isadigit{2}}{\isacharcomma}\ {\isasymacute}len{\isadigit{2}}{\isacharparenright}\isanewline
\ \ FI\isanewline
CATCH\ Skip\ END\isanewline
{\isachardoublequoteclose}\isanewline
\isacommand{print{\isacharunderscore}locale}\isamarkupfalse%
\ merge{\isacharunderscore}at{\isacharunderscore}impl\isanewline
\isanewline
\isacommand{procedures}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{imports}\ globals{\isacharunderscore}var{\isacharparenright}\isanewline
merge{\isacharunderscore}collapse{\isacharparenleft}{\isacharparenright}\ \isanewline
\isakeyword{where}\ n{\isacharcolon}{\isacharcolon}nat\ \isakeyword{in}\isanewline
{\isachardoublequoteopen}TRY\ \isanewline
\ \ WHILE\ {\isasymacute}stack{\isacharunderscore}size\ {\isachargreater}\ {\isadigit{1}}\ \isanewline
\ \ DO\isanewline
\ \ \ \ {\isasymacute}n\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}stack{\isacharunderscore}size{\isacharminus}{\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ IF\ {\isacharparenleft}{\isasymacute}n{\isachargreater}{\isadigit{0}}\ {\isasymand}\ {\isasymacute}run{\isacharunderscore}len{\isacharbang}{\isacharparenleft}{\isasymacute}n{\isacharminus}{\isadigit{1}}{\isacharparenright}\ {\isasymle}\ {\isasymacute}run{\isacharunderscore}len{\isacharbang}{\isasymacute}n\ {\isacharplus}\ {\isasymacute}run{\isacharunderscore}len{\isacharbang}{\isacharparenleft}{\isasymacute}n{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ \ \ {\isasymor}\ {\isacharparenleft}{\isasymacute}n{\isachargreater}{\isadigit{1}}\ {\isasymand}\ {\isasymacute}run{\isacharunderscore}len{\isacharbang}{\isacharparenleft}{\isasymacute}n{\isacharminus}{\isadigit{2}}{\isacharparenright}\ {\isasymle}\ {\isasymacute}run{\isacharunderscore}len{\isacharbang}{\isacharparenleft}{\isasymacute}n{\isacharminus}{\isadigit{1}}{\isacharparenright}\ {\isacharplus}\ {\isasymacute}run{\isacharunderscore}len{\isacharbang}{\isasymacute}n{\isacharparenright}\isanewline
\ \ \ \ THEN\ \isanewline
\ \ \ \ \ \ IF\ {\isasymacute}run{\isacharunderscore}len{\isacharbang}{\isacharparenleft}{\isasymacute}n{\isacharminus}{\isadigit{1}}{\isacharparenright}\ {\isacharless}\ {\isasymacute}run{\isacharunderscore}len{\isacharbang}{\isacharparenleft}{\isasymacute}n{\isacharplus}{\isadigit{1}}{\isacharparenright}\ \isanewline
\ \ \ \ \ \ THEN\ \isanewline
\ \ \ \ \ \ \ \ {\isasymacute}n{\isacharcolon}{\isacharequal}{\isacharequal}{\isasymacute}n{\isacharminus}{\isadigit{1}}\ \isanewline
\ \ \ \ \ \ FI\isanewline
\ \ \ \ ELSE\ \isanewline
\ \ \ \ \ \ IF\ {\isasymacute}n{\isacharless}{\isadigit{0}}\ {\isasymor}\ {\isasymacute}run{\isacharunderscore}len{\isacharbang}{\isasymacute}n\ {\isachargreater}\ {\isasymacute}run{\isacharunderscore}len{\isacharbang}{\isacharparenleft}{\isasymacute}n{\isacharplus}{\isadigit{1}}{\isacharparenright}\ \isanewline
\ \ \ \ \ \ THEN\ \isanewline
\ \ \ \ \ \ \ \ THROW\ \isanewline
\ \ \ \ \ \ FI\isanewline
\ \ \ \ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ \ CALL\ merge{\isacharunderscore}at{\isacharparenleft}{\isasymacute}n{\isacharparenright}\ \isanewline
\ \ OD\ \isanewline
CATCH\ SKIP\ END{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{print{\isacharunderscore}locale}\isamarkupfalse%
\ merge{\isacharunderscore}collapse{\isacharunderscore}impl\isanewline
\isanewline
\isacommand{procedures}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{imports}\ globals{\isacharunderscore}var{\isacharparenright}\isanewline
push{\isacharunderscore}run{\isacharparenleft}run{\isacharunderscore}base{\isacharunderscore}i{\isacharcolon}{\isacharcolon}nat{\isacharcomma}\ run{\isacharunderscore}len{\isacharunderscore}i{\isacharcolon}{\isacharcolon}nat{\isacharparenright}\isanewline
{\isachardoublequoteopen}{\isasymacute}run{\isacharunderscore}base{\isacharbang}{\isasymacute}stack{\isacharunderscore}size\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}run{\isacharunderscore}base{\isacharunderscore}i\ {\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}run{\isacharunderscore}len{\isacharbang}{\isasymacute}stack{\isacharunderscore}size\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}run{\isacharunderscore}len{\isacharunderscore}i\ {\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}stack{\isacharunderscore}size\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}stack{\isacharunderscore}size\ {\isacharplus}\ {\isadigit{1}}{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{procedures}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{imports}\ globals{\isacharunderscore}var{\isacharparenright}\isanewline
merge{\isacharunderscore}force{\isacharunderscore}collapse{\isacharparenleft}{\isacharparenright}\isanewline
\isakeyword{where}\ n{\isacharcolon}{\isacharcolon}nat\ \isakeyword{in}\isanewline
{\isachardoublequoteopen}WHILE\ {\isasymacute}stack{\isacharunderscore}size\ {\isachargreater}\ {\isadigit{1}}\ \isanewline
DO\isanewline
\ \ {\isasymacute}n\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}stack{\isacharunderscore}size\ {\isacharminus}\ {\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ IF\ {\isacharparenleft}{\isasymacute}n\ {\isachargreater}\ {\isadigit{0}}\ {\isasymand}\ {\isasymacute}run{\isacharunderscore}len{\isacharbang}{\isacharparenleft}{\isasymacute}n{\isacharminus}{\isadigit{1}}{\isacharparenright}\ {\isacharless}\ {\isasymacute}run{\isacharunderscore}len{\isacharbang}{\isacharparenleft}{\isasymacute}n{\isacharplus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\ \isanewline
\ \ THEN\ \isanewline
\ \ \ \ {\isasymacute}n{\isacharcolon}{\isacharequal}{\isacharequal}{\isasymacute}n\ {\isacharminus}\ {\isadigit{1}}\ \isanewline
\ \ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ CALL\ merge{\isacharunderscore}at{\isacharparenleft}{\isasymacute}n{\isacharparenright}\ \isanewline
OD{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
\isacommand{procedures}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{imports}\ globals{\isacharunderscore}var{\isacharparenright}\isanewline
reverse{\isacharunderscore}range{\isacharparenleft}array{\isacharcolon}{\isacharcolon}{\isachardoublequoteopen}int\ list{\isachardoublequoteclose}{\isacharcomma}\ lo{\isacharcolon}{\isacharcolon}nat{\isacharcomma}\ hi{\isacharcolon}{\isacharcolon}nat{\isacharbar}\ ret{\isacharcolon}{\isacharcolon}{\isachardoublequoteopen}int\ list{\isachardoublequoteclose}{\isacharparenright}\isanewline
\isakeyword{where}\ t{\isacharcolon}{\isacharcolon}int\ \isakeyword{in}\isanewline
{\isachardoublequoteopen}\isanewline
TRY\isanewline
IF\ {\isasymacute}hi\ {\isacharequal}\ {\isadigit{0}}\ THEN\ THROW\ ELSE\ {\isacharparenleft}{\isacharasterisk}\ to\ address\ the\ problem\ of\ natural\ number\ {\isacharasterisk}{\isacharparenright}\isanewline
{\isasymacute}hi{\isacharcolon}{\isacharequal}{\isacharequal}{\isasymacute}hi{\isacharminus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
WHILE\ {\isasymacute}lo\ {\isacharless}\ {\isasymacute}hi\ DO\isanewline
\ {\isasymacute}t{\isacharcolon}{\isacharequal}{\isacharequal}{\isasymacute}array{\isacharbang}{\isasymacute}lo{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}array{\isacharbang}{\isasymacute}lo\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}array{\isacharbang}{\isasymacute}hi{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}array{\isacharbang}{\isasymacute}hi\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}t{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}lo\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}lo{\isacharplus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}hi\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}hi{\isacharminus}{\isadigit{1}}\isanewline
OD\ FI\isanewline
CATCH\ Skip\ END{\isacharsemicolon}{\isacharsemicolon}\isanewline
{\isasymacute}ret\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}array{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{procedures}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{imports}\ globals{\isacharunderscore}var{\isacharparenright}\isanewline
count{\isacharunderscore}run{\isacharunderscore}and{\isacharunderscore}make{\isacharunderscore}ascending{\isacharparenleft}array{\isacharcolon}{\isacharcolon}{\isachardoublequoteopen}int\ list{\isachardoublequoteclose}{\isacharcomma}\ lo{\isacharcolon}{\isacharcolon}nat{\isacharcomma}\ hi{\isacharcolon}{\isacharcolon}nat{\isacharbar}\ ret{\isacharunderscore}value{\isacharcolon}{\isacharcolon}nat{\isacharcomma}\ ret{\isacharcolon}{\isacharcolon}{\isachardoublequoteopen}int\ list{\isachardoublequoteclose}{\isacharparenright}\isanewline
\isakeyword{where}\ run{\isacharunderscore}hi{\isacharcolon}{\isacharcolon}nat\ \isakeyword{in}\isanewline
{\isachardoublequoteopen}\isanewline
{\isasymacute}run{\isacharunderscore}hi{\isacharcolon}{\isacharequal}{\isacharequal}{\isasymacute}lo{\isacharplus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
TRY\isanewline
\ IF\ {\isasymacute}run{\isacharunderscore}hi\ {\isacharequal}\ {\isasymacute}hi\ THEN\ {\isasymacute}ret{\isacharunderscore}value{\isacharcolon}{\isacharequal}{\isacharequal}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}{\isasymacute}ret\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}array{\isacharsemicolon}{\isacharsemicolon}THROW\ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ IF\ {\isasymacute}array{\isacharbang}{\isasymacute}run{\isacharunderscore}hi\ {\isacharless}\ {\isasymacute}array{\isacharbang}{\isasymacute}lo\isanewline
\ THEN\isanewline
\ \ {\isasymacute}run{\isacharunderscore}hi\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}run{\isacharunderscore}hi{\isacharplus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ WHILE\ {\isacharparenleft}{\isasymacute}run{\isacharunderscore}hi\ {\isacharless}\ {\isasymacute}hi\ {\isacharampersand}\ {\isasymacute}array{\isacharbang}{\isasymacute}run{\isacharunderscore}hi\ {\isacharless}\ {\isasymacute}array{\isacharbang}{\isacharparenleft}{\isasymacute}run{\isacharunderscore}hi{\isacharminus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ DO\ {\isasymacute}run{\isacharunderscore}hi\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}run{\isacharunderscore}hi{\isacharplus}{\isadigit{1}}\ OD{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}array\ {\isacharcolon}{\isacharequal}{\isacharequal}\ CALL\ reverse{\isacharunderscore}range{\isacharparenleft}{\isasymacute}array{\isacharcomma}\ {\isasymacute}lo{\isacharcomma}\ {\isasymacute}run{\isacharunderscore}hi{\isacharparenright}\isanewline
\ ELSE\isanewline
\ \ {\isasymacute}run{\isacharunderscore}hi\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}run{\isacharunderscore}hi{\isacharplus}{\isadigit{1}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ WHILE\ {\isacharparenleft}{\isasymacute}run{\isacharunderscore}hi\ {\isacharless}\ {\isasymacute}hi\ {\isacharampersand}\ {\isasymacute}array{\isacharbang}{\isasymacute}run{\isacharunderscore}hi\ {\isasymge}\ {\isasymacute}array{\isacharbang}{\isacharparenleft}{\isasymacute}run{\isacharunderscore}hi{\isacharminus}{\isadigit{1}}{\isacharparenright}{\isacharparenright}\isanewline
\ \ DO\ {\isasymacute}run{\isacharunderscore}hi\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}run{\isacharunderscore}hi{\isacharplus}{\isadigit{1}}\ OD\isanewline
\ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}ret{\isacharunderscore}value\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}run{\isacharunderscore}hi\ {\isacharminus}\ {\isasymacute}lo{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}ret\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}array\isanewline
CATCH\ Skip\ END{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{procedures}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{imports}\ globals{\isacharunderscore}var{\isacharparenright}\isanewline
binary{\isacharunderscore}sort{\isacharparenleft}array{\isacharcolon}{\isacharcolon}{\isachardoublequoteopen}int\ list{\isachardoublequoteclose}{\isacharcomma}\ lo{\isacharcolon}{\isacharcolon}nat{\isacharcomma}\ hi{\isacharcolon}{\isacharcolon}nat{\isacharcomma}\ start{\isacharcolon}{\isacharcolon}nat{\isacharbar}\ ret{\isacharcolon}{\isacharcolon}{\isachardoublequoteopen}int\ list{\isachardoublequoteclose}{\isacharparenright}\isanewline
\isakeyword{where}\ pivot{\isacharcolon}{\isacharcolon}int\ left{\isacharcolon}{\isacharcolon}nat\ right{\isacharcolon}{\isacharcolon}nat\ mid{\isacharcolon}{\isacharcolon}nat\ move{\isacharcolon}{\isacharcolon}nat\ \isakeyword{in}\isanewline
{\isachardoublequoteopen}\isanewline
IF\ {\isasymacute}start\ {\isacharequal}\ {\isasymacute}lo\ THEN\ {\isasymacute}start\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}start\ {\isacharplus}\ {\isadigit{1}}\ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
WHILE\ {\isasymacute}start\ {\isacharless}\ {\isasymacute}hi\ DO\isanewline
\ {\isasymacute}pivot\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}array{\isacharbang}{\isasymacute}start{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}left\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}lo{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}right\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}start{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ WHILE\ {\isasymacute}left\ {\isacharless}\ {\isasymacute}right\ DO\isanewline
\ \ {\isasymacute}mid\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isacharparenleft}{\isasymacute}left{\isacharplus}{\isasymacute}right{\isacharparenright}\ div\ {\isadigit{2}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ IF\ {\isasymacute}pivot\ {\isacharless}\ {\isasymacute}array{\isacharbang}{\isasymacute}mid\ \isanewline
\ \ THEN\ \isanewline
\ \ \ \ {\isasymacute}right\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}mid\ \isanewline
\ \ ELSE\ \isanewline
\ \ \ \ {\isasymacute}left\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}mid{\isacharplus}{\isadigit{1}}\ \isanewline
\ \ FI\isanewline
\ OD{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}move\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}start\ {\isacharminus}\ {\isasymacute}left{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}array\ {\isacharcolon}{\isacharequal}{\isacharequal}\ list{\isacharunderscore}copy\ {\isasymacute}array\ {\isacharparenleft}{\isasymacute}left{\isacharplus}{\isadigit{1}}{\isacharparenright}\ {\isasymacute}array\ {\isasymacute}left\ {\isasymacute}move{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}array{\isacharbang}{\isasymacute}left\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}pivot{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}start\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}start\ {\isacharplus}\ {\isadigit{1}}\isanewline
OD{\isacharsemicolon}{\isacharsemicolon}\isanewline
{\isasymacute}ret\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}array\isanewline
{\isachardoublequoteclose}\isanewline
\isanewline
\isacommand{procedures}\isamarkupfalse%
\ {\isacharparenleft}\isakeyword{imports}\ globals{\isacharunderscore}var{\isacharparenright}\isanewline
sort{\isacharparenleft}array{\isacharcolon}{\isacharcolon}{\isachardoublequoteopen}int\ list{\isachardoublequoteclose}{\isacharcomma}\ lo{\isacharcolon}{\isacharcolon}nat{\isacharcomma}\ hi{\isacharcolon}{\isacharcolon}nat{\isacharbar}\ ret{\isacharcolon}{\isacharcolon}{\isachardoublequoteopen}int\ list{\isachardoublequoteclose}{\isacharparenright}\isanewline
\isakeyword{where}\ min{\isacharunderscore}run{\isacharcolon}{\isacharcolon}nat\ n{\isacharunderscore}remaining{\isacharcolon}{\isacharcolon}nat\ run{\isacharunderscore}len{\isacharunderscore}i{\isacharcolon}{\isacharcolon}nat\ force{\isacharcolon}{\isacharcolon}nat\ init{\isacharunderscore}run{\isacharunderscore}len{\isacharunderscore}i{\isacharcolon}{\isacharcolon}nat\ \isakeyword{in}\isanewline
{\isachardoublequoteopen}\isanewline
TRY\isanewline
{\isasymacute}n{\isacharunderscore}remaining\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}hi\ {\isacharminus}\ {\isasymacute}lo{\isacharsemicolon}{\isacharsemicolon}\isanewline
IF\ {\isacharparenleft}{\isasymacute}n{\isacharunderscore}remaining\ {\isacharless}\ {\isadigit{2}}{\isacharparenright}\ THEN\ {\isasymacute}ret\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}array{\isacharsemicolon}{\isacharsemicolon}\ THROW\ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
IF\ {\isacharparenleft}{\isasymacute}n{\isacharunderscore}remaining\ {\isacharless}\ {\isadigit{3}}{\isadigit{2}}{\isacharparenright}\ THEN\isanewline
\ \ \ CALL\ count{\isacharunderscore}run{\isacharunderscore}and{\isacharunderscore}make{\isacharunderscore}ascending{\isacharparenleft}{\isasymacute}array{\isacharcomma}\ {\isasymacute}lo{\isacharcomma}\ {\isasymacute}hi{\isacharcomma}\ {\isasymacute}init{\isacharunderscore}run{\isacharunderscore}len{\isacharunderscore}i{\isacharcomma}\ {\isasymacute}array{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}{\isacharparenleft}{\isacharasterisk}\ return\ two\ values{\isacharasterisk}{\isacharparenright}\isanewline
\ \ {\isasymacute}array\ {\isacharcolon}{\isacharequal}{\isacharequal}\ CALL\ binary{\isacharunderscore}sort{\isacharparenleft}{\isasymacute}array{\isacharcomma}\ {\isasymacute}lo{\isacharcomma}\ {\isasymacute}hi{\isacharcomma}\ {\isasymacute}lo{\isacharplus}{\isasymacute}init{\isacharunderscore}run{\isacharunderscore}len{\isacharunderscore}i{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ {\isasymacute}ret\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}array{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ THROW\isanewline
FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
{\isasymacute}a{\isacharcolon}{\isacharequal}{\isacharequal}{\isasymacute}array{\isacharsemicolon}{\isacharsemicolon}\isanewline
{\isasymacute}stack{\isacharunderscore}size\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isadigit{0}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
{\isasymacute}min{\isacharunderscore}run\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isadigit{1}}{\isadigit{6}}{\isacharsemicolon}{\isacharsemicolon}\isanewline
IF\ size\ {\isasymacute}a\ {\isacharless}\ {\isadigit{1}}{\isadigit{2}}{\isadigit{0}}\ THEN\ {\isasymacute}stack{\isacharunderscore}len\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isadigit{4}}\ ELSE\isanewline
IF\ size\ {\isasymacute}a\ {\isacharless}\ {\isadigit{1}}{\isadigit{5}}{\isadigit{4}}{\isadigit{2}}\ THEN\ {\isasymacute}stack{\isacharunderscore}len\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isadigit{9}}\ ELSE\isanewline
IF\ size\ {\isasymacute}a\ {\isacharless}\ {\isadigit{1}}{\isadigit{1}}{\isadigit{9}}{\isadigit{1}}{\isadigit{5}}{\isadigit{1}}\ THEN\ {\isasymacute}stack{\isacharunderscore}len\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isadigit{1}}{\isadigit{8}}\ ELSE\isanewline
{\isasymacute}stack{\isacharunderscore}len\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isadigit{3}}{\isadigit{9}}\ FI\ FI\ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
{\isasymacute}run{\isacharunderscore}len\ {\isacharcolon}{\isacharequal}{\isacharequal}\ replicate\ {\isasymacute}stack{\isacharunderscore}len\ {\isacharparenleft}{\isadigit{0}}{\isacharcolon}{\isacharcolon}nat{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
{\isasymacute}run{\isacharunderscore}base\ {\isacharcolon}{\isacharequal}{\isacharequal}\ replicate\ {\isasymacute}stack{\isacharunderscore}len\ {\isacharparenleft}{\isadigit{0}}{\isacharcolon}{\isacharcolon}nat{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
CALL\ count{\isacharunderscore}run{\isacharunderscore}and{\isacharunderscore}make{\isacharunderscore}ascending{\isacharparenleft}{\isasymacute}a{\isacharcomma}\ {\isasymacute}lo{\isacharcomma}\ {\isasymacute}hi{\isacharcomma}\ {\isasymacute}run{\isacharunderscore}len{\isacharunderscore}i{\isacharcomma}\ {\isasymacute}a{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ IF\ {\isasymacute}run{\isacharunderscore}len{\isacharunderscore}i\ {\isacharless}\ {\isasymacute}min{\isacharunderscore}run\ THEN\isanewline
\ \ \ IF\ {\isasymacute}n{\isacharunderscore}remaining\ {\isasymle}\ {\isasymacute}min{\isacharunderscore}run\ THEN\isanewline
\ \ \ \ {\isasymacute}force\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}n{\isacharunderscore}remaining\isanewline
\ \ \ ELSE\isanewline
\ \ \ \ {\isasymacute}force\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}min{\isacharunderscore}run\isanewline
\ \ \ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ {\isasymacute}a\ {\isacharcolon}{\isacharequal}{\isacharequal}\ CALL\ binary{\isacharunderscore}sort{\isacharparenleft}{\isasymacute}a{\isacharcomma}\ {\isasymacute}lo{\isacharcomma}\ {\isasymacute}lo{\isacharplus}{\isasymacute}force{\isacharcomma}\ {\isasymacute}lo{\isacharplus}{\isasymacute}run{\isacharunderscore}len{\isacharunderscore}i{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ {\isasymacute}run{\isacharunderscore}len{\isacharunderscore}i\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}force\isanewline
\ \ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ CALL\ push{\isacharunderscore}run{\isacharparenleft}{\isasymacute}lo{\isacharcomma}\ {\isasymacute}run{\isacharunderscore}len{\isacharunderscore}i{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ CALL\ merge{\isacharunderscore}collapse{\isacharparenleft}{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}lo\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}lo\ {\isacharplus}\ {\isasymacute}run{\isacharunderscore}len{\isacharunderscore}i{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}n{\isacharunderscore}remaining\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}n{\isacharunderscore}remaining\ {\isacharminus}\ {\isasymacute}run{\isacharunderscore}len{\isacharunderscore}i{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ WHILE\ {\isasymacute}n{\isacharunderscore}remaining\ {\isasymnoteq}\ {\isadigit{0}}\ DO\ \isanewline
\ CALL\ count{\isacharunderscore}run{\isacharunderscore}and{\isacharunderscore}make{\isacharunderscore}ascending{\isacharparenleft}{\isasymacute}a{\isacharcomma}\ {\isasymacute}lo{\isacharcomma}\ {\isasymacute}hi\ {\isacharcomma}{\isasymacute}run{\isacharunderscore}len{\isacharunderscore}i{\isacharcomma}\ {\isasymacute}a{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ IF\ {\isasymacute}run{\isacharunderscore}len{\isacharunderscore}i\ {\isacharless}\ {\isasymacute}min{\isacharunderscore}run\ THEN\isanewline
\ \ \ IF\ {\isasymacute}n{\isacharunderscore}remaining\ {\isasymle}\ {\isasymacute}min{\isacharunderscore}run\ THEN\isanewline
\ \ \ \ {\isasymacute}force\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}n{\isacharunderscore}remaining\isanewline
\ \ \ ELSE\isanewline
\ \ \ \ {\isasymacute}force\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}min{\isacharunderscore}run\isanewline
\ \ \ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ {\isasymacute}a\ {\isacharcolon}{\isacharequal}{\isacharequal}\ CALL\ binary{\isacharunderscore}sort{\isacharparenleft}{\isasymacute}a{\isacharcomma}\ {\isasymacute}lo{\isacharcomma}\ {\isasymacute}lo{\isacharplus}{\isasymacute}force{\isacharcomma}\ {\isasymacute}lo{\isacharplus}{\isasymacute}run{\isacharunderscore}len{\isacharunderscore}i{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ \ \ {\isasymacute}run{\isacharunderscore}len{\isacharunderscore}i\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}force\isanewline
\ \ FI{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ CALL\ push{\isacharunderscore}run{\isacharparenleft}{\isasymacute}lo{\isacharcomma}\ {\isasymacute}run{\isacharunderscore}len{\isacharunderscore}i{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ CALL\ merge{\isacharunderscore}collapse{\isacharparenleft}{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}lo\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}lo\ {\isacharplus}\ {\isasymacute}run{\isacharunderscore}len{\isacharunderscore}i{\isacharsemicolon}{\isacharsemicolon}\isanewline
\ {\isasymacute}n{\isacharunderscore}remaining\ {\isacharcolon}{\isacharequal}{\isacharequal}\ {\isasymacute}n{\isacharunderscore}remaining\ {\isacharminus}\ {\isasymacute}run{\isacharunderscore}len{\isacharunderscore}i\isanewline
\ OD{\isacharsemicolon}{\isacharsemicolon}\isanewline
CALL\ merge{\isacharunderscore}force{\isacharunderscore}collapse{\isacharparenleft}{\isacharparenright}{\isacharsemicolon}{\isacharsemicolon}\isanewline
{\isasymacute}ret{\isacharcolon}{\isacharequal}{\isacharequal}{\isasymacute}a\isanewline
CATCH\ Skip\ END\isanewline
{\isachardoublequoteclose}\isanewline
\isanewline
\isanewline
%
\isadelimtheory
\isanewline
%
\endisadelimtheory
%
\isatagtheory
\isacommand{end}\isamarkupfalse%
%
\endisatagtheory
{\isafoldtheory}%
%
\isadelimtheory
%
\endisadelimtheory
%
\end{isabellebody}%
%%% Local Variables:
%%% mode: latex
%%% TeX-master: "root"
%%% End:
